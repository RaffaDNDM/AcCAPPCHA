\chapter{Side-channel attacks}\label{chapter:SideCH}
A side-channel attack is an attack in which the malicious user exploits a side-information of transmitted encrypted data, to give access to the user's private data. 
This type of extra information is usually: timing information, power consumption, electromagnetic radiations, sound and so on.\\
In the past the main side-channel attacks require the physical access to the victim's device. Nowadays, side-channel attacks are evolved and can be conducted by remote hackers using malicious code (e.g. cache-timing attacks, DRAM row buffer attacks), even exploiting information from sensors on mobile devices\cite{side_classification}.\\
In fact an hacker can obtain side-channel information on mobile devices, from several sensors\cite{side_attacks}:
\begin{itemize}
\item{Location sensors (e.g. GPS, proximity)}
\item{Motion sensors (e.g. accelerometer, gyroscope, magnetometer)}
\item{Environmental sensors (e.g. for ambient light, temperature, barometer)}
\item{Biometric sensors for wearable devices (e.g. heart rate sensor, ECG)}
\item{Audio sensors (microphone)}
\item{Video sensors (camera)}
\end{itemize}
Side-channel attacks can usually be classified, looking at the action performed by the attacker, in the following categories:
\begin{itemize}
\descItem{active}{the hacker influences the behaviour of the victim's device}
\descItem{passive}{the attacker only analyses the leaking information}
\end{itemize}
Side-channel attacks can also be classified, looking at the distance between the hacker and the victim during the attack, in the following classes:
\begin{itemize}
\item{Local attacks}
\item{Vicinity attacks}
\item{Remote attacks}
\end{itemize}
In this chapter there is a summary of the most popular side-channel attacks, organized with respect to the previous classifications (see \myref{Table}{sc:review}). This study was conducted to find a feasible side-channel to be used in the design phase of a new CAPTCHA scheme, as support to the authentication phase.

\section{Local side-channel attacks}
In local attacks, the attacker needs to get the target device or to be very near to it. In many cases the hacker physically needs to manipulate the device or to obtain access to the chip.\\\\
\textbf{Passive attacks}\\
The following attacks are used to break cryptographic system implementations:
\begin{itemize}
\descItem{\textit{Power Analysis}}
{this type of attacks are based on the analysis of the power variations in transistors. There exist several popular attacks\cite{intro_DPA}:
\begin{itemize}
\descItem{\textit{Simple Power Analysis (SPA)}}
{the attacker analyses the power consumption of the system, that depends on the microprocessor used. This analysis can be useful to understand which operations are performed by different implementations of cryptographic algorithm (e.g. RSA, DES).}
\descItem{\textit{Differential Power Analysis (DPA)}}
{this attack collects data and then performs a statistical analysis and some error correction techniques from data to extract information correlated with secret keys.}
\descItem{\textit{High Order DPA (HO-DPA)}}
{While DPA obtains information across a single event, HO-DPA correlates with multiple cryptographic sub-operations.}
\end{itemize}}
\descItem{\textit{Electromagnetic Analysis Attacks}}
{the attacker can analyse indirectly the power consumption by accessing electromagnetic signals of the victim's machine. This type of attacks depends on the used instruments (e.g. EM probes) and on the analysed location of the chip. These dependencies also affect the signal-to-noise ratio.}
\descItem{\textit{Differential Computation Analysis}}
{the attacker tries to exploit white-box cryptographic implementations. In this model the attacker, even if he has access to code, can't extract the secret key. Hence the hacker needs to have full control over the target device and the execution environment. Then using binary instruments, he can control the intermediate states of the memory or memory operations (e.g. reading/writing operations)\cite{side_DCA}.}
\descItem{\textit{Smudge Attacks}}
{the attacker can exploit fingerprints and smudges on the screen of mobile devices to evaluate the user's input.}
\descItem{\textit{Shoulder Surfing and Reflections}}
{the attacker can exploit the lightness of the device display and obtain the user's activity by its reflection on sunglasses or tea pods.}
\descItem{\textit{Hand/Device Movements}}
{the attacker exploits the user's movements of fingers and hand to understand the interaction of the victim with the device.}
\end{itemize}
\textbf{Active attacks}\\
The following attacks require that the hacker physically gets the device for a while:
\begin{itemize}
\descItem{\textit{Clock/Power Glitching}}
{in the past the attacker can fault inject on embedded devices by exploiting variations of the clock signal, (e.g. overclocking). However he needs to use an external clock source to do it.}
\descItem{\textit{Electromagnetic Fault Injection (EMFI)}}
{the attacker uses short (e.g. nanoseconds) high-energy electromagnetic pulses to change the state of memory cells. This attack allows to target specific regions of a microchip by locating the EM probe (e.g. on the instruction memory, the data memory, or CPU registers).}
\descItem{\textit{Laser/Optical Faults}}
{the attacker needs to decapsulate the chip to obtain access to it and, using a laser beam, it change the state of a transistor (e.g. changing bit value of a memory cell).}
\descItem{\textit{Temperature Variation}}
{the attacker can change the temperature, in which the target device is working, causing malfunctioning of the hardware. Temperature higher than the maximum one, supported by the hardware, causes faults in memory cells. Temperature too low changes the speed, for which the content of the RAM disappear, after turning the device off.}
\descItem{\textit{Differential Computation Analysis}}
{the attacker needs to have full control of the white-box environment, manipulating intermediate values in the system computation.}
\descItem{\textit{NAND Mirroring}}
{the attacker exploits the duplication of the data, usually used to recover data after faults, to restore a previous system state. The hacker can force the reset of the state as demonstrated by Skorobogatov for an Apple device\cite{side_Apple}.}
\end{itemize}

\section{Vicinity side-channel attacks}
The attacker needs to wiretap or eavesdrop the network communication of the victim or to be in the neighbourhood of the target.\\\\
\textbf{Passive attacks}
\begin{itemize}
\descItem{\textit{Network Traffic Analysis}}
{the attacker can exploit meta data, related to the encrypted data, transmitted over the network. This information gives access to sensitive information about the traffic.\\
For example a Web-application works between two parties: the client and the server. For this reason the communication channel is usually encrypted and the requests made by the user work through the \textit{HTTPS} protocol.\\
This solution isn't enough to prevent an attacker from exploiting reserved data because each web page has a distinct size and loads resources of different sizes. Hence the attacker can fingerprint the page even if HTTPS protocol is used.\\
Another cause of these attacks on Web-services is given by the trend of Web to work on \textit{stateful protocols}, providing better performance to the client by keeping track of the connection information. TCP session for example works on Stateful Protocol because both systems maintain information about the session itself during its life\cite{side_leaks}.}
\descItem{\textit{USB Power Analysis}}
{the attacker can modify USB charging stations for mobile devices to obtain an analysis about the power consumption and the related sensitive information.}
\descItem{\textit{Wi-Fi Signal Monitoring}}
{Wi-Fi devices continuously monitor the wireless channel (channel state information (CSI)) to transmit data. Any environmental variation (e.g. finger motion) affects Wireless signals, generating unique patterns. For example the attacker can exploit these variations to unlock patterns on smartphones\cite{side_CSI}.}
\end{itemize}
\textbf{Active attacks}
\begin{itemize}
\descItem{Network Traffic Analysis}
{the attacker, after obtaining information about transmitted packets, can interfere the traffic (e.g. delay of packets).}
\end{itemize}


\section{Remote side-channel attacks}
These attacks are software-only based and they depend on the installation of the malicious code on the target device.\\
\textbf{Passive attacks}
\begin{itemize}
\descItem{\textit{Linux-inherited procfs Leaks}}
{the attacker can obtain a lot of information for each running process on Linux File System, looking at the content of the files in \myref{Table}{sc:proc}.
\begin{table}[H]
\centering \footnotesize
\renewcommand*\arraystretch{1.3}
\begin{tabular}{rl}
\toprule
\multicolumn{1}{c}{\textbf{File path}} & \multicolumn{1}{c}{\textbf{Information}}\\
\midrule
{\textbf{\textit{/proc/[pid]/statm}}} & {Virtual and physical memory sizes of process with identifier \textit{[pid]}}\\
{\textbf{\textit{/proc/[pid]/stat}}} & {CPU utilization times of process with identifier \textit{[pid]}}\\
{\textbf{\textit{/proc/[pid]/status}}} & {Number of context switches of process with identifier \textit{[pid]}}\\
{\textbf{\textit{/proc/interrupts}}} & {Interrupt counters}\\
{\textbf{\textit{/proc/stat}}} & {Context switches}\\
\bottomrule
\end{tabular}
\caption{\footnotesize{Files used to obtain information about running processes.}}
\label{sc:proc}
\end{table}
}
\descItem{\textit{Data-Usage Statistics}}
{the attacker can access to information, about incoming and outgoing network traffic, of each application without any permission.}
\descItem{\textit{Page Deduplication}}
{To reduce the overall memory footprint of a system, some operating systems perform deduplication, searching for identical pages within the physical memory and merge them even across different processes. When a process tries to write on a deduplicated page, a copy-on-write fault occurs and the process gets its own copy of this memory region again.}
\descItem{\textit{Microarchitectural Attacks}}
{By measuring execution times and memory accesses, the attacker can obtain sensitive information from processes running in parallel on the same device. This type of information can be evaluated from CPU caches, that are a big source of information leaks.}
\descItem{\textit{Sensor-based Keyloggers}}
{in mobile devices, the attacker can exploit information from equipped sensors with any permission. The user's interaction with the device can be evaluated by analysing information from the sensors.}
\descItem{\textit{Fingerprinting Devices/Users}}
{the attacker can obtain the identity of the device and the user and also the fingerprint by exploiting hardware issues and cookies.}
\descItem{\textit{Location Inference}}
{the attacker can obtain user's location without using GPS sensor, that requires permission to be accessed. For example, the accelerometer and the gyroscope can be used to infer car driving routes.}
\descItem{\textit{Speech Recognition}}
{the access to the microphone is protected by permissions. The attacker can also exploit gyroscope to obtain information about human speech near to the device.}
\descItem{\textit{Soundcomber}}
{if the attacker obtains permission of the microphone, he can obtain sensitive information (e.g. credit card numbers) on the automated menu services of phones.}
\end{itemize}
\vspace{2cm}
\textbf{Active attacks}
\begin{itemize}
\descItem{\textit{Rowhammer}}
{the attacker can induce hardware faults by frequent accesses to main memory. This happens because the size of DRAM cells decreases nowadays to increase the density of memory cells in DRAM. However this causes electromagnetic coupling effects between near cells.}
\end{itemize}

\begin{sidewaystable}[h]
\centering \footnotesize
\renewcommand*\arraystretch{1.3}
\begin{tabular}{rlll}
\toprule
{} & \multicolumn{1}{c}{\textbf{Local}} & \multicolumn{1}{c}{\textbf{Vicinity}} & \multicolumn{1}{c}{\textbf{Remote}}\\
\midrule
\verticalCell{9}{\textbf{Passive}} & \itemCellTab{Power Analysis} & \itemCellTab{Network Traffic Analysis} & \itemCellTab{Linux-inherited procfs Leaks}\\
& \itemCellTab{Electromagnetic Analysis Attacks} &  \itemCellTab{USB Power Analysis} & \itemCellTab{Data-Usage Statistics}\\
& \itemCellTab{Differential Computation Analysis} & \itemCellTab{Wi-Fi Signal Monitoring} & \itemCellTab{Page Deduplication}\\
& \itemCellTab{Smudge Attacks} &  & \itemCellTab{Microarchitectural Attacks}\\
& \itemCellTab{Shoulder Surfing and Reflections} &  & \itemCellTab{Sensor-based Keyloggers}\\
& \itemCellTab{Hand/Device Movements} &  & \itemCellTab{Fingerprinting Devices/Users}\\
&  &  & \itemCellTab{Location Inference}\\
&  &  & \itemCellTab{Speech Recognition}\\
&  &  & \itemCellTab{Soundcomber}\\
\midrule
\verticalCell{6}{\textbf{Active}} & \itemCellTab{Clock/Power Glitching} &\\
& \itemCellTab{Electromagnetic Fault Injection (EMFI)} & \itemCellTab{Network Traffic Analysis} & \itemCellTab{Rowhammer}\\
& \itemCellTab{Laser/Optical Faults} &  & \\
& \itemCellTab{Temperature Variation} &  & \\
& \itemCellTab{Differential Computation Analysis} &  & \\
& \itemCellTab{NAND Mirroring} &  & \\
\bottomrule
\end{tabular}
\caption{\footnotesize{Survey of the most popular side-channel attacks\cite{side_classification}.}}
\label{sc:review}
\end{sidewaystable}