\chapter{State of the Art}\label{chapter:StateOfArt}
CAPTCHA is the acronym of \textit{"Completely Automated Public Turing-test-to-tell Computers and Humans Apart"} and it's a challenge born from these two components\cite{types_CAPTCHA}:
\begin{enumerate}
\descItem{Human-Computer Interaction (HCI)}
{it is a research field that studies the computer technology, looking at the interfaces between the users and the machines. A human can interact with a machine at several levels:
\begin{itemize}
	\item{Task level}
	\item{Semantic level}
	\item{Syntactic level}
	\item{Interactive level}
	\item{Physical devices level}
\end{itemize}
This discipline tries to analyse the ways in which a human can process data, matching the user's needs and interests. According to cognitive psychology studies, the human interaction with the machine is based on:
\begin{itemize}
	\item{Reasoning}
	\item{Problem solving}
	\item{Skill acquisition}
	\item{Error}
\end{itemize}   
}
\descItem{Human Interactive Proof (HIP)}
{it's a proof used to classify machines and humans looking at a specific type of interaction, that is simple to be done by a human instead of a bot. The main goals of the test are:
\begin{itemize}
	\item{To differentiate the humans from the computers}
	\item{To differentiate a category of the humans}
	\item{To differentiate a specific human from the category of humans}
\end{itemize}
HIP consists of a test program administered to humans and computers. The main problem of this proof is that the complexity of the task is often very complex and only a specific group of humans can usually solve the test.\\
Historically the most widely known version is the cognitive one defined by Alan Turing. The Turing test is used to determine how much a machine is capable of thinking like a human. The experiment involves three figures: a human examiner, a human and a machine. The examiner asks some questions to the other figures and, after a fixed amount of time, he evaluates if the two answers were different or not.\\
If they were similar, with respect to the point of view of the examiner, the machine is classified as an AI (Artificial Intelligence). The test is very reliable if each question could have many possible answers.}
\end{enumerate}
The design of CAPTCHA challenges takes inspiration from the previous components because its goal is to establish if the user is a bot or a human. A bot is usually an advanced program that exploits some AI techniques and pretends to be a human. In the endeavor of foiling bots that are getting every day smarter and more sophisticated, a CAPTCHA challenge sometimes is so complex that a human user can't solve it. For this reason and in order to guarantee an high level of security, a CAPTCHA has to satisfy the following requirements:
\begin{itemize}
	\item{There exists only one solution of a CAPTCHA and it shouldn't depend on the user's language and/or age;}
	\item{The solution of a CAPTCHA must be easy for the humans and hard for the bots. In fact humans should solve it in no longer than 30 seconds with very high success rate (30 seconds are usually considered too much time to solve a CAPTCHA);}
	\item{The creation of a CAPTCHA shouldn't affect the user privacy.}
\end{itemize}
Over the year, the CAPTCHAs must satisfy more and more requirements and the challenges become more and more complex reducing the usability of them. For this reason, a new generation of CAPTCHAs, that we define modern CAPTCHAs, has been developed in the last years. The new challenges are related to a good exploitation of the biometrics and the sensors of modern devices. In addition, machine learning techniques and side-channel information are used to evaluate the user behaviour instead of generating challenges based on cognitive capabilities. 

%\vspace{4cm}
\section{Traditional CAPTCHAs}
The traditional CAPTCHAs are based on the knowledge and the correct insertion of the solution by the user. These CAPTCHA schemes are designed to leverage character recognition, image analysis and speech recognition to guarantee that the challenges will successfully block bots.\\
The main types of traditional CAPTCHAs, namely Audio-based CAPTCHAs, Game-based CAPTCHAs, Image-based CAPTCHAs, Math CAPTCHAs, Slider CAPTCHAs, Text-based CAPTCHAs and Video-based CAPTCHAs, are described in the following sections but the details about specific implementations can be found in the article of Walid Khalifa Abdullah Hasan\cite{survey_advanced_CAPTCHA}. With respect to user experience, the most enjoyable traditional CAPTCHAs are usually the game-based and image-based ones while the most frustrating CAPTCHA is the text-based one\cite{usability_CAPTCHA}. A summary of usability and security issues, explained in the following sections, is also reported in \myref{Table}{soa:traditional_table}.

\subsection{Audio-based CAPTCHAs}
This type of CAPTCHAs asks the user to type the words contained in an audio file (see \myref{Figure}{soa:audio_CAPTCHA}). It's developed for vision-impaired users. Audio-based CAPTCHAs usually have problems in usability related to the language dictionary, from which the words are taken, and the similarity of sound for several words. This CAPTCHA is a hard task even for blind users, in fact  during an experiment only 46\% of the challenges were solved by the participants\cite{usability_audio}.\\
One of the most popular Audio-Based CAPTCHAs is \textit{Audio reCAPTCHA}, developed at Carnegie Mellon University and then bought by Google. In this scheme, the user needs to recognize and write a set of 8 spoken characters from a noisy audio file with several background voices. If the user makes a mistake, the test declares that he's a bot.\\
Audio-based CAPTCHAs are vulnerable to many Automatic Speech Recognition (ASR) programs\cite{improving_audio} but also Deep Learning techniques (e.g. DeepCRACk\cite{DeepCRACk}). A good overview about results, obtained by several classification methods, is described in the work of Jennifer Tam et al.\cite{break_audio}.
\begin{figure}[h]
     \centering
     \includegraphics[width=.4\linewidth]{Images/StateOfArt/audio_CAPTCHA}
     \caption{\footnotesize{Example of audio-based CAPTCHA.}}\label{soa:audio_CAPTCHA}
\end{figure}

\subsection{Game-based CAPTCHAs}
This type of CAPTCHAs performs the verification of the user identity through a set of several kinds of games (see \myref{Figure}{soa:game}). The strength of Game-based CAPTCHAs is related to the the rules of the game that only humans can understand.\\
There exists an implementation of these CAPTCHAs, called \textit{Dynamic Cognitive Game (DCG)}, that is usually developed using Flash, HTML5 and JavaScript. These technologies download the game code to the client and execute it locally.\\
The code of these challenges must be the obfuscated to prevent to prevent the attacker from analysing the code. In fact, the obfuscation guarantees that the source code can not be stored on different internet domains. However for example, there exists a bot attack, called \textit{Stream Relay Attack}, that obtains good results bypassing these challenges \cite{game_CAPTCHA} (see \myref{Section}{soa:security_CAPTCHAs}).
\begin{figure}[h]
     \centering
     \begin{subfigure}[b]{0.48\textwidth}
         \centering
         \includegraphics[width=.9\linewidth]{Images/StateOfArt/game_CAPTCHA}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.48\textwidth}
         \centering
         \includegraphics[width=.9\linewidth]{Images/StateOfArt/game_CAPTCHA2}
     \end{subfigure}
		
	 \begin{subfigure}[b]{0.55\textwidth}
         \centering
         \includegraphics[width=\linewidth]{Images/StateOfArt/game_CAPTCHA3}
     \end{subfigure}
     \caption{\footnotesize{Examples of game-based CAPTCHAs.}}
     \label{soa:game}
\end{figure}

\subsection{Image-based CAPTCHAs}
Image-based CAPTCHAs is based on a written text that describes a task related to the evaluation of some images. The user must understand the action and he passes the test if he performs it in the right way. This type of CAPTCHAs can be categorized into the following classes, looking at the task that the user needs to perform:
\begin{itemize}
\descItem{Click-based CAPTCHAs}
{this type of CAPTCHAs shows an image and a text that explains where the user needs to click (see \myref{Figure}{soa:click_CAPTCHA}).
\begin{figure}[h]
     \centering
     \includegraphics[width=.45\linewidth]{Images/StateOfArt/click_CAPTCHA}
     \caption{\footnotesize{Example of click-based CAPTCHA.}}\label{soa:click_CAPTCHA}
\end{figure}
}
\descItem{Sliding image-based CAPTCHAs}
{this type of CAPTCHAs asks the user to use the slider to solve an image-based challenge such as adjusting the orientation of an image, selecting the correct form of an image, or moving a fragment of an image to the correct location (see \myref{Figure}{soa:sliding_image}).
\begin{figure}[h]
     \centering
     \begin{subfigure}[b]{0.48\textwidth}
         \centering
         \includegraphics[width=.9\linewidth]{Images/StateOfArt/sliding_image_CAPTCHA}
	     \caption{\footnotesize{Orientation based.}}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.48\textwidth}
         \centering
         \includegraphics[width=.9\linewidth]{Images/StateOfArt/sliding_image_CAPTCHA2}
	     \caption{\footnotesize{Form based.}}
     \end{subfigure}
     \caption{\footnotesize{Examples of sliding image-based CAPTCHAs.}}
     \label{soa:sliding_image}
\end{figure}
}
\descItem{Drag \& Drop-based CAPTCHAs}
{this type of CAPTCHAs usually asks the user to complete a visual puzzle, created by dividing a given image in a set of pieces\cite{survey_CAPTCHA} (see \myref{Figure}{soa:puzzle}).\\
The task isn't easy for users because this type of CAPTCHAs takes more time to solve the puzzle but the security level is very high\cite{survey_CAPTCHA}. To improve the usability of the CAPTCHA, there exists a version of the puzzle-based CAPTCHA in which the user needs to insert only some pieces of the puzzle instead to complete it (see \myref{Figure}{soa:puzzle2}).
\begin{figure}[h]
     \centering
     \begin{subfigure}[b]{0.48\textwidth}
         \centering
         \includegraphics[width=.6\linewidth]{Images/StateOfArt/puzzle_CAPTCHA}
         \caption{\footnotesize{Completing the puzzle.}}
         \label{soa:puzzle}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.48\textwidth}
         \centering
         \includegraphics[width=.6\linewidth]{Images/StateOfArt/puzzle_CAPTCHA2}
         \caption{\footnotesize{Inserting only some pieces.}}
        \label{soa:puzzle2}
     \end{subfigure}
     \caption{\footnotesize{Examples of puzzle-based CAPTCHAs.}}
\end{figure}
}
\descItem{Selection-based CAPTCHAs}
{the user usually needs to select the images that contain a requested subject. The set of images, on which the user needs to identify the subject, can be created in several ways, for example:
\begin{itemize}
\item{An image is divided into a set of sub-squares and each of them is a candidate image (see \myref{Figure}{soa:selection})}
\item{There are many images, each one with a unique different subject (see \myref{Figure}{soa:selection2})}
\end{itemize}
This type of CAPTCHAs is vulnerable to different Object Recognition techniques developed for Computer Vision purposes.\\
An extension of this type of CAPTCHAs, called \textit{FaceDCAPTCHA}, has been introduced\cite{FaceDCAPTCHA} and it incorporates elements of face detection. The human brain is very effective in the process of natural face segmentation even if there are complex backgrounds. In fact, this approach increases the security efficiency because the Computer Vision programs can easily detect if there is a face, e.g. Viola-Jones algorithm\cite{Viola_Jones}, but they have many problems understanding if the photographs of the faces are real or not.\\
One of the most difficult challenges, to be performed by a computer, is the detection of faces, fingerprints and eyes in an image. For this reason the previous idea has been used to to develop a new version of image-based CAPTCHA, called \textit{MB CAPTCHA}\cite{MB_CAPTCHA}.
\begin{figure}[h]
     \centering
     \begin{subfigure}[b]{0.48\textwidth}
         \centering
         \includegraphics[width=.68\linewidth]{Images/StateOfArt/selection_CAPTCHA}
         \caption{\footnotesize{With an image divided in sub-squares.}}
         \label{soa:selection}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.48\textwidth}
         \centering
         \includegraphics[width=.68\linewidth]{Images/StateOfArt/selection_CAPTCHA2}
         \caption{\footnotesize{With several images.}}
        \label{soa:selection2}
     \end{subfigure}
     \caption{\footnotesize{Examples of selection-based CAPTCHAs.}}
\end{figure}
}
\descItem{Interactive-based CAPTCHAs}
{the user needs to discover a secret position in an image using mouse movements or swiping gestures
\begin{figure}[h]
     \centering
     \includegraphics[width=.4\linewidth]{Images/StateOfArt/interactive_CAPTCHA}
     \caption{\footnotesize{Example of interactive-based CAPTCHA.}}\label{soa:interactive_CAPTCHA}
\end{figure}
}
\end{itemize}

\subsection{Math CAPTCHAs}
Looking to a math operation, specified in a frame, the user needs to insert the result in a text field. The operation is written in plain text or, to improve the security of this challenge, it's warped like text-based CAPTCHAs (see \myref{Figure}{soa:arithmetic}). These classical math-CAPTCHAs, also known as \textit{arithmetic CAPTCHAs}, are vulnerable to OCR (Optical Character Recognition) techniques.\\
\begin{figure}[h]
     \centering
     \begin{subfigure}[b]{0.48\textwidth}
         \centering
         \includegraphics[width=.7\linewidth]{Images/StateOfArt/math_CAPTCHA}
         \caption{\footnotesize{With plain text.}}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.48\textwidth}
         \centering
         \includegraphics[width=.7\textwidth]{Images/StateOfArt/math_CAPTCHA2}
         \caption{\footnotesize{With wrapped text.}}
     \end{subfigure}
		\caption{\footnotesize{Example of arithmetic CAPTCHAs.}}
		\label{soa:arithmetic}
\end{figure}
An advanced version of this CAPTCHA is used in the Quantum Random Bit Generator Service (QRBGS) sign-up Web Page\cite{math_CAPTCHA} (see \myref{Figure}{soa:QRBGS}). This type of CAPTCHA asks the user to solve an advanced math expression. It prevents the use of free or commercial OCR techniques because many mathematical symbols are not considered in the traditional detection algorithms. Hence many math symbols are wrongly translated by bot programs and the challenge is very secure. However, this CAPTCHA is vulnerable to side-channel attacks \cite{math_CAPTCHA} and it's very complex for normal users. In fact many people can't solve it correctly because the required level of math knowledge is very high and not very common.
\begin{figure}[h]
     \centering
     \includegraphics[width=.4\linewidth]{Images/StateOfArt/QRBGS}
     \caption{\footnotesize{Example of Quantum Random Bit Generator Service (QRBGS) sign-up Web Page \cite{math_CAPTCHA}.}}\label{soa:QRBGS}
\end{figure}

\subsection{Slider CAPTCHAs}
Slider CAPTCHAs ask users to move a slider across the screen. The image recognition is not part of the challenge.\\
The most popular CAPTCHAs of this type are the following:
\begin{itemize}
\descItem{CAPTCHA used by Taobao.com}{it asks the user to drag the slider from the start to the end of the sliding bar to verify his identity (see \myref{Figure}{soa:slider}).}
\descItem{CAPTCHA used by TheyMakeApps.com}{it asks the user to move the slider to the end of the line to submit a form\cite{sliding_CAPTCHA} (see \myref{Figure}{soa:slider2}).}
\end{itemize}
Over the years several implementations of this type of CAPTCHAs have been bypassed with a simple JavaScript code and puppeteer.
\begin{figure}[h]
     \centering
     \begin{subfigure}[b]{0.48\textwidth}
         \centering
         \includegraphics[width=.8\linewidth]{Images/StateOfArt/taobao_CAPTCHA}
                  \caption{\footnotesize{Example of TaoBao.com CAPTCHA.}}
         \label{soa:slider}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.48\textwidth}
         \centering
         \includegraphics[width=.8\linewidth]{Images/StateOfArt/theyMakeApps_CAPTCHA}
         \caption{\footnotesize{Example of TheyMakeApps.com CAPTCHA.}}
        \label{soa:slider2}
     \end{subfigure}
     \caption{\footnotesize{Examples of slider CAPTCHAs.}}
\end{figure}

\subsection{Text-based CAPTCHAs}
In text-based CAPTCHA schemes a random series of warped characters and/or numbers is displayed on the screen inside an image (see \myref{Figure}{soa:text_CAPTCHA}). The user needs to understand which are the characters that composes the sequence and then he types them inside a text-field. The most known classes of text-based CAPTCHAs are:
\begin{itemize}
\descItem{2D}{the warped characters of the text are placed and oriented in a 2D plane, parallel to the screen plane. The image of the 2D plane is used in the challenge.}
\descItem{3D}{each warped character of the text is mapped into a 3D model of the character and then is placed and oriented in a 3D plane in the space. A 2D image of the 3D space is taken from a specific point of view and it's used in the challenge.}
\end{itemize}
This type of CAPTCHAs is vulnerable to several attacks, related to Computer Vision techniques:
\begin{itemize}
\item{OCR techniques\cite{OCR}}
\item{Segmentation techniques (e.g. DECAPTCHA\cite{DECAPTCHA})}
\item{Machine Learning and Deep Learning techniques}
\end{itemize}
In the design phase of a text-based CAPTCHA there are many issues, related to Computer Vision attacks, to be considered. For each of them, there is usually a solution in the design phase of the CAPTCHA that reduces the probability that the challenge will be broken by a bot\cite{DECAPTCHA}.
\begin{figure}[h]
     \centering
     \includegraphics[width=.55\linewidth]{Images/StateOfArt/text_CAPTCHA}
     \caption{\footnotesize{Example of text-based CAPTCHA.}}\label{soa:text_CAPTCHA}
\end{figure}

\subsection{Video-based CAPTCHAs}
This type of CAPTCHAs isn't very common because it requires the download of a very large file\cite{survey_advanced_CAPTCHA}. The traditional video-based CAPTCHA is composed by a video in which a sliding text is shown (see \myref{Figure}{soa:video}). The user needs to type this message in a text field to pass the challenge. Some implementations of this type of CAPTCHAs are vulnerable to machine learning attacks.\\
Another version of the CAPTCHA is \textit{Motion CAPTCHA}\cite{Motion_CAPTCHA}, developed by M. Shirali-shahreza and S. Shirali-shahreza, in which the user needs to watch a video. Then he needs to select which action was performed in the played file, choosing it from multiple answers (see \myref{Figure}{soa:video2}). The strength of these implementations of CAPTCHAs is in the relationship between the multiple choices of the answer\cite{video_attack}.\\
A similar implementation of the previous version is the one developed by Kluever et al. in which the user watches a video and then he needs to write three words that describe what he sees\cite{video_desc}. The same authors created a tag frequency-based attack to evaluate the security of their CAPTCHA scheme and they achieve a success rate of 13\%.
\begin{figure}[h]
     \centering
     \begin{subfigure}[b]{0.48\textwidth}
         \centering
         \includegraphics[width=\linewidth]{Images/StateOfArt/video_CAPTCHA}
         \caption{\footnotesize{Example of sliding text in video.}}
         \label{soa:video}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.48\textwidth}
         \centering
         \includegraphics[width=\linewidth]{Images/StateOfArt/video_CAPTCHA2}
         \caption{\footnotesize{Example of Motion CAPTCHA\cite{Motion_CAPTCHA}.}}
        \label{soa:video2}
     \end{subfigure}
     \caption{\footnotesize{Examples of video-based CAPTCHAs.}}
\end{figure}

\section{Modern CAPTCHAs}
The type of CAPTCHAs and authentication mechanisms, described in the following sections, are different from traditional CAPTCHAs because they don't challenge the cognitive capabilities of a human user. They work leveraging other parameters, such as behavioural analysis and data from the sensors. In the following sections there is a summary of the most known CAPTCHA schemes of this type.

\subsection{Biometrics-based CAPTCHAs}\label{soa:Bio_CAPTCHA}
Biometric-based CAPTCHAs are very often used to support the authentication mechanisms of a user. The most known schemes of this type are the following:
\begin{itemize}
\descItem{Bio-CAPTCHA voice-based Authentication}
{This authentication method was developed starting from good results reached in the authentication phase of cloud systems\cite{voice_CAPTCHA} (Alexa for Amazon, Siri for Apple, Cortana for Microsoft). This particular implementation uses a random voice-based password challenge. This password changes at every login and the user needs to say it out loud. The strength of the challenge is the peculiarity of the human voice. The experiments reveals that unauthorized access probability decreases, while the usability is very high because it requires only the access to the microphone.}
\descItem{rtCAPTCHA}{this type of authentication method is a Real-time CAPTCHA that asks users to perform some tasks like smile, blink or nod in front of the camera of the mobile phone. The recorded video is sent to the service provider that checks if there is the expected user performing the required action in the file.\\
In the work of Erkam Uzun, Simon Pak Ho Chung, Irfan Essa and Wenke Lee\cite{rtCAPTCHA}, there is a detailed comparison between other similar authentication mechanisms and rtCAPTCHA, evaluating all possible Computer Vision attacks.}
\end{itemize}

\subsection{Behavioural-based CAPTCHAs}
In 2014 Google announced that the Artificial Intelligence can solve now even the most difficult variant of text-based CAPTCHAs at 99.8\% accuracy\cite{break_text}. For this reason, the company develops the following CAPTCHA schemes:
\begin{itemize}
\descItem{Google no CAPTCHA}
{Google developed this new CAPTCHA system in 2015. It's simpler than traditional CAPTCHAs in terms of user interaction\cite{google}. This CAPTCHA system is composed by two layers of protection:
\begin{enumerate}
\item{Checkbox \textit{"I'm not a robot"} to be clicked by the user as shown in \myref{Figure}{soa:noCAPTCHA} (or image-based CAPTCHA on mobile devices)
\begin{figure}[h]
     \centering
     \includegraphics[width=.4\linewidth]{Images/StateOfArt/noCAPTCHA}
     \caption{\footnotesize{Example of Google no CAPTCHA checkbox.}}\label{soa:noCAPTCHA}
\end{figure}
}
\item{Traditional text-based CAPTCHA with two warped words}
\end{enumerate}
The second layer is reached only if the user doesn't succeed in the first one. For the checkbox step, the application evaluates in background the user's behaviour (e.g. the mouse movement, where the user clicks, how long he lingers over a checkbox). Then the program performs an \textit{advanced risk analysis}, by looking at the results of the first step, the spam traffic and the number of passed/failed challenges. In this way the CAPTCHA understands if the test is passed or not.\\
The experimental results confirm that the first phase is very inefficient and many times the user fails performing this challenge even if he was a human and was performing correctly the task. A problem of this type of CAPTCHA is that many attacks exploits the image-based CAPTCHA (used on mobile phones) and the text-based CAPTCHA of the second phase using attacks based on known Computer Vision techniques or their variants (e.g. CAPTCHA breaker made by Suphannee Sivakorn, Jason Polakis and Angelos D. Keromytis\cite{break_google}).
}
%HERE
\descItem{Google Invisible ReCAPTCHA}
{it's a top layer over the \textit{Google noCAPTCHA v2.0}. It adds the option to bind the CAPTCHA directly to the formâ€™s submit element. In this way, the programmer can add layers to reduce the user experience of a bot\cite{google}. It usually requires the use of cookies to track the user's behaviour. There exist two version of this CAPTCHA:
\begin{itemize}
\descItem{ReCAPTCHA v2.0}
{it was developed in 2017. It's not really invisible because Privacy \& Policy badge must be included on every pages of an app or a website in which the CAPTCHA is used. Computer Vision and Artificial Intelligence algorithms can break the challenges by recognizing object in the pictures in the image-based CAPTCHA phase.}
\descItem{ReCAPTCHA v3.0}
{it was developed in 2018. It constantly analyses the human behavior, the mouse movements, the typing speed and the other features in NO CAPTCHA technology until Google collects enough data to tune their Google Invisible reCAPTCHA v2.0. This type of CAPTCHAs uses the probability scores of Artificial Intelligence and Machine Learning, the hostname, the timestamp and the action validation.\\
Google removes the image recognition phase and looking only at the score, it evaluates if the user is a human or a bot. The main difference with respect to the previous versions of Google modern CAPTCHAs is that it returns a probability score, called \textit{risk score}, in the range $[0.0, 1.0]$: \textit{0.0} if the user is a bot, \textit{1.0} otherwise. The administrator of the website can decide what range of scores he wants to manage, declaring when the site is under attack and what actions need to be performed.\\
Over the year, several peculiarities and problems of this version of \textit{Invisible ReCAPTCHA} were discovered. For example:
\begin{itemize}
\item{If a user accesses a Web page using incognito mode or private mode, he is classified with a very low score (\textit{high risk}).}
\item{If a human is wrongly classified as a bot, the user can login into its Google account to increase its score. If this doesn't change the classification, you cannot do anything else.}
\end{itemize}
}
\end{itemize}
}
\end{itemize}

\subsection{Sensor-based CAPTCHAs}
The devices, with access to the net, have natively many sensors nowadays, like the gyroscope and the accelerometer. The CAPTCHA schemes, described in the following sections, leverage the data generated from these sensors to improve the security of the authentication.
\begin{itemize}
\descItem{Completely Automated Public Physical test to tell Computer and Humans Apart (CAPPCHA)}
{this is a way to enforce the PIN authentication phase by mobile phone\cite{CAPPCHA}. The user needs to tilt the device to a specified angle, specified on the screen (see \myref{Figure}{soa:CAPPCHA}). The CAPPCHA security is based on the \textit{Secure Element} (\textit{SE}) in the device. It prevents brute force, side channel and recording attacks. The usability results are good because many comments, made by the users, were also considered in the implementation.
\begin{figure}[h]
     \centering
     \includegraphics[width=.8\linewidth]{Images/StateOfArt/CAPPCHA}
     \caption{\footnotesize{CAPPCHA and PIN authentication\cite{CAPPCHA}.}}\label{soa:CAPPCHA}
\end{figure}
}
\descItem{Invisible CAPPCHA}
{It will be described in details in \myref{Chapter}{chapter:InvisibleCAPPCHA}.}
\end{itemize}

\section{CAPTCHA security}\label{soa:security_CAPTCHAs}
The process used to break many traditional CAPTCHAs, based on text or images, is usually organized into the following phases\cite{CAPTCHA_attack_process}:
\begin{enumerate}
\descItem{Pre-processing phase}
{in this phase, several techniques are applied to remove background, to separate foreground from the background, to delete noise and to remove some particular pattern (e.g. Canny Detection and Scale-Invariant Feature Transform (SIFT) application).
}
\descItem{Attack phase}
{the following techniques are usually applied:
\begin{itemize}
\descItem{\textit{Object recognition attacks}}
{The most used techniques are pattern matching (e.g. shape context matching, correlation algorithm), OCR recognition, SIFT and machine learning. They are usually applied after the segmentation of the image with several methods (e.g. vertical histogram, color filling, snake segmentation and JSEG).}
\descItem{\textit{Random Guess Attacks}}
{The attacker's program tries to break the CAPTCHA scheme by guessing the correct answer. This attack is effective on CAPTCHAs with few number of different challenges.}
\descItem{\textit{Human Solver Relay Attacks}}
{The bot forwards the CAPTCHA challenge to a remote human worker that will solve it if the previous phases don't produce good results. This technique is usually used also to solve other types of CAPTCHAs.}
\end{itemize}
}
\end{enumerate}
Many CAPTCHA schemes have still several issues:
\begin{itemize}
\descItem{Session issue}
{Some types of CAPTCHAs have a big issue because they don't destroy the session, after a correct answer is inserted by the user\cite{text_audio}.\\
Hence, the hacker can crack the next accesses using the same session id with the related solution of the challenge, after connecting to the web page of CAPTCHA. In this way the attacker can make hundreds of requests before the session expires and the previous operation must be computed again.}
\descItem{Resilience to both automated and human solver relay attacks}
{Many CAPTCHA schemes are designed to be robust against a possible AI attack but the new generation of CAPTCHAs involves the use of remote bot or human solver. Traditional CAPTCHA schemes are vulnerable to this type of attacks.\\
Sensor-based CAPTCHAs are often vulnerable to relay attacks. An exception is the \textit{Invisible CAPPCHA}, that will be analysed in \myref{Chapter}{chapter:InvisibleCAPPCHA}.
}
\descItem{Limited number of challenges}
{An issue of sensor-based CAPTCHA schemes is the limited number of challenges because the design of many usable gestures is very hard. This problem could be solved
relying on trusted hardware.}
\descItem{Trade-off between Friction-heavy and Frictionless CAPTCHAs}
{A trade-off between usability and security aspects is always considered analysing CAPTCHA schemes. This condition is exacerbated in behavioural and sensor-based CAPTCHAs.}
\descItem{User's privacy}
{Sensor-based and behavioural CAPTCHAs usually send useful information to a remote server that analyses it to establish if the user was a human or a bot. If an hacker attacks the server side of this application, he can access users' private data.\\
In some CAPTCHAs, the information is evaluated on the client side by a trusted hardware and the server receives only the results of the analysis. In this case, we need to be sure that trusted hardware is secure enough to guarantee privacy of user's information.
}
\descItem{Compatibility with different devices}
{Many CAPTCHA schemes, e.g. behavioural ones, use specific forms factors but a good challenge should be compatible with different factors.}
\end{itemize}

\begin{sidewaystable}
\centering \footnotesize
\renewcommand*\arraystretch{1.3}
\begin{tabular}{ccll}
\toprule
\multicolumn{1}{c}{\textbf{Type}} & \multicolumn{1}{c}{\textbf{Scheme}} & \multicolumn{1}{c}{\textbf{Usability issues}} & \multicolumn{1}{c}{\textbf{Security}}\\
\midrule
%Audio row
\multirow{3}{*}{\textbf{\textit{Audio}}} & {\textit{Audio reCAPTCHA}} & {Issues of recognition:} & {It's vulnerable to:}\\
&&{\itemCell{Knowledge of English dictionary by the user.}}&{\itemCell{ASR programs.}}\\
&&{\itemCell{Some character sounds very similar to others.}}&{\itemCell{Deep Learning and ML techniques.}}\\
\midrule
\multirow{2}{*}{\textbf{\textit{Game}}} & {\textit{Dynamic Cognitive}} & {Comprehension of rules.} & {Vulnerable to Stream Relay Attack}\\
& {\textit{Game (DCG)}} &&\\
\midrule
\multirow{5}{*}{\textbf{\textit{Image}}} & {\textit{Click-based}} & {Difficulty in identification of images caused by:} & {Vulnerable to:}\\
& {\textit{Drag \& Drop-based}} & {\itemCell{Blur of images.}} & {\itemCell{Segmentation techniques}}\\
& {\textit{Sliding-based}} & {\itemCell{Low vision condition.}} & {\itemCell{Deep Learning and ML techniques}}\\
& {\textit{Selection-based}} && {OCR techniques}\\
& {\textit{Interactive-based}} &&\\
\midrule
%Math row
\multirow{3}{*}{\textbf{\textit{Math}}} & {\textit{Arithmetic}} & {It requires basic or advanced} & {Vulnerable to:}\\
{} & {\textit{QRBGS}} & {math knowledge.} & {\itemCell{OCR techniques}}\\
&&&{\itemCell{Side-channel attacks}}\\
\midrule
\multirow{2}{*}{\textbf{\textit{Slider}}} & {Taobao.com} & {Simple and intuitive interaction} & {Simple bypassed by Javascript code}\\
& {TheyMakeApps.com} & {} & {and pupeeteer}\\
\midrule
\multirow{5}{*}{\textbf{\textit{Text}}} & {\textit{2D}} & {Many problems have to be solved by user:} & {It can be identified by:}\\
&{\textit{3D}}&{\itemCell{Multiple fonts}}&{\itemCell{OCR technique}}\\
&&{\itemCell{Font size}}&{\itemCell{Segmentation techniques}}\\
&&{\itemCell{Blurred Letters}}&{\itemCell{Deep Learning and ML techniques}}\\
&&{\itemCell{Wave Motion}}&\\
\midrule
{\textbf{\textit{Video}}} & {\textit{Motion CAPTCHA}} & {Heavy file to be downloaded} & {}\\
\bottomrule
\end{tabular}
\caption{\footnotesize{Survey of main types of traditional CAPTCHAs\cite{survey_CAPTCHA}.}}
\label{soa:traditional_table}
\end{sidewaystable}

\begin{comment}
\begin{sidewaystable}
\centering \footnotesize
\renewcommand*\arraystretch{1.3}
\begin{tabular}{ccll}
\toprule
\multicolumn{1}{c}{\textbf{Alternative Type}} & \multicolumn{1}{c}{\textbf{Name of implementation}} & \multicolumn{1}{c}{\textbf{Usability issues}} & \multicolumn{1}{c}{\textbf{Security}}\\
\midrule
\textit{} & {} & {}\\
\bottomrule
\end{tabular}
\caption{\footnotesize{Survey of main types of alternatives of CAPTCHAs\cite{survey_CAPTCHA}.}}
\label{soa:modern_table}
\end{sidewaystable}
\end{comment}